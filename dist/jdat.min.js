/*! jdat - v0.1.0 - 2014-01-03
* https://github.com/medihack/jdat
* Copyright (c) 2014 Kai Schlamp; Licensed MIT */
var JDat=JDat||{};!function(a){"use strict";JDat.extend=function(b,c,d){var e=function(){};e.prototype=c.prototype,b.prototype=new e,b.prototype.constructor=b,a.extend(b.prototype,d)},JDat.ColorHelper={hex2hsv:function(a){var b=parseInt(a.slice(1),16),c=b>>16&255,d=b>>8&255,e=255&b;return this.rgb2hsv([c,d,e])},hsv2hex:function(a){var b=this.hsv2rgb(a);return this.rgb2hex(b)},hsv2rgb:function(a){var b,c,d,e,f,g=a[0]%360/60;f=a[2]*a[1],e=f*(1-Math.abs(g%2-1)),b=c=d=a[2]-f,g=~~g,b+=[f,e,0,0,e,f][g],c+=[e,f,f,e,0,0][g],d+=[0,0,e,f,f,e][g];var h=Math.floor(255*b),i=Math.floor(255*c),j=Math.floor(255*d);return[h,i,j]},rgb2hex:function(a){var b=a[0],c=a[1],d=a[2];return"#"+(16777216|d|c<<8|b<<16).toString(16).slice(1)},rgb2hsv:function(a){var b=a[0],c=a[1],d=a[2];(a[0]>1||a[1]>1||a[2]>1)&&(b/=255,c/=255,d/=255);var e,f,g,h;return g=Math.max(b,c,d),h=g-Math.min(b,c,d),e=0==h?null:g==b?(c-d)/h+(d>c?6:0):g==c?(d-b)/h+2:(b-c)/h+4,e=e%6*60,f=0==h?0:h/g,[e,f,g]}},JDat.BaseField=function(){var b={id:null,binding:null,label:null,titleize:!1,onSetup:null,onChange:null,onFinishChange:null,onUpdateView:null,onUpdateModel:null},c=function(c,d){this._el=c,this._options=a.extend({},b,d),this._render(),this._options.onSetup&&this._options.onSetup.call(this)};return c.prototype={constructor:c,_initialize:function(){this._options.value&&this.value(this._options.value,!1),this.updateView()},_trigger:function(a,b){a.source=this,this._options.onUpdateModel&&this._options.onUpdateModel.call(this,this._options.model,this._options.binding,a.value,b),this._options.onChange&&this._options.onChange.call(this,a),(void 0===b||b)&&this._options.onFinishChange&&this._options.onFinishChange.call(this,a)},_template:function(){var b=a('<div class="jdat-field-container">').appendTo(this._el);if(!this._options.label)return b;var c=a('<div class="jdat-field-panel">'),d=a('<span class="jdat-field-label">');return this._options.titleize&&d.addClass("jdat-title"),b.append(d).append(c),this.label(this._options.label),c},id:function(){return this._options.id},label:function(a){return void 0===a?this._options.label:(this._options.label=a,this._el.find(".jdat-field-label").text(a),void 0)},onChange:function(a){return void 0===a?this._options.onChange:(this._options.onChange=a,void 0)},show:function(b){var c=this;this._el.slideDown("fast",function(){a(this).show(),a.isFunction(b)&&b.call(c)})},hide:function(b){var c=this;this._el.slideUp("fast",function(){a(this).hide(),a.isFunction(b)&&b.call(c)})},enable:function(){this._el.find(a(".jdat-field-disabler").remove())},disable:function(b){var c=this._el.find(".jdat-field-disabler");c.length||(c=a('<div class="jdat-field-disabler">').appendTo(this._el),b&&c.addClass("jdat-loading"))},updateView:function(){this._options.onUpdateView&&this._options.onUpdateView.call(this,this._options.model,this._options.binding)}},c}(),JDat.SectionField=function(){var b={label:"Section",title:!0,closeable:!0,closed:!1,indent:!0},c=function(c,d){c.addClass("jdat-section");var e=a.extend({},b,d);JDat.BaseField.call(this,c,e),this._bindClose(),this._options.closed&&this.close()};return JDat.extend(c,JDat.BaseField,{_render:function(){this._options.title&&(this._template().remove(),this._el.find(".jdat-field-label").addClass("jdat-section-title").addClass("jdat-title"),this._options.closeable&&this._el.find(".jdat-field-container").prepend(a('<div class="jdat-arrow-down">')));var b=a('<ul class="jdat-section-panel">').appendTo(this._el);this._options.indent&&b.addClass("jdat-indent")},_bindClose:function(){var a=this;this._options.closeable&&this._el.find(".jdat-field-container:eq(0)").click(function(){return a.closed?a.open():a.close(),!1})},add:function(b,c){var d=a("<li>").addClass("jdat-field").appendTo(this._el.find(".jdat-section-panel:eq(0)"));c.id&&d.attr("id",c.id),!c.model&&this._options.model&&(c.model=this._options.model),c.onUpdateView||(c.onUpdateView=this._options.onUpdateView),c.onUpdateModel||(c.onUpdateModel=this._options.onUpdateModel);var e=new b(d,c);return d.data("jdat",e),e},open:function(b){var c=this;this._el.find(".jdat-section-panel:eq(0)").slideDown("fast",function(){a(this).show(),a.isFunction(b)&&b.call(c)}),this._el.find(".jdat-arrow-right:eq(0)").removeClass("jdat-arrow-right").addClass("jdat-arrow-down"),this.closed=!1},close:function(b){var c=this;this._el.find(".jdat-section-panel:eq(0)").slideUp("fast",function(){a(this).hide(),a.isFunction(b)&&b.call(c)}),this._el.find(".jdat-arrow-down:eq(0)").removeClass("jdat-arrow-down").addClass("jdat-arrow-right"),this.closed=!0},empty:function(){this._el.find(".jdat-section-panel:eq(0)").empty()},updateView:function(){this._el.find(".jdat-field").each(function(){a(this).hasClass("jdat-section")||a(this).data("jdat").updateView()})}}),c}(),JDat.Widget=function(){var b={resizeable:!0,resizer:"right",closeBar:"bottom",openLabel:"Open",closeLabel:"Close",titleBar:!0,title:"",undockable:!0,removable:!0,collapsible:!0,settings:!1,onSettings:function(){},model:null,onUpdateView:function(a,b){a&&b&&this.value(a[b],!1)},onUpdateModel:function(a,b,c){a&&b&&(a[b]=c)}},c=function(c,d){this._el=c,this._options=a.extend({},b,d),this._render(),this._bindClose(),this._bindResize(),this._bindRemove(),this._bindDocking(),this._bindSettings(),this.closed&&this.close()};return JDat.extend(c,JDat.SectionField,{_render:function(){var b=this;if(this.widget=a('<div class="jdat-widget">'),this._options.resizeable){var c=a('<div class="jdat-resizer">');"right"==this._options.resizer?c.addClass("jdat-right"):c.addClass("jdat-left"),c.appendTo(this.widget)}if(this._options.titleBar&&this._createTitleBar(),this.widget.append(a('<ul class="jdat-section-panel">')),this._options.closeBar){var d=a('<a href="#" class="jdat-closebar">').text(b._options.closeLabel);"bottom"==this._options.closeBar?this.widget.append(d):this.widget.prepend(d)}this.widget.appendTo(this._el)},_createTitleBar:function(){var b=a('<div class="jdat-titlebar">');this._options.resizeable&&b.append(a('<div class="jdat-resize-knob">')),this._options.title&&b.append(a('<div class="jdat-titlebar-title jdat-title">').text(this._options.title)),this._options.removable&&b.append(a('<button class="jdat-remove">')),this._options.collapsible&&b.append(a('<button class="jdat-collapse">')),this._options.undockable&&b.append(a('<button class="jdat-undock">')),this._options.settings&&b.append(a('<button class="jdat-settings">')),b.appendTo(this.widget)},_bindClose:function(){var a=this;this.widget.find(".jdat-closebar, button.jdat-collapse").click(function(){return a.closed?a.open():a.close(),!1})},_bindResize:function(){var b=this;this.widget.find(".jdat-resizer").mousedown(function(c){if(1===c.which){var d=b.widget.width(),e=function(a){return d+a},f=[c.pageX,c.pageY];return a(window).on("mousemove.jdatDrag",function(a){var c=[a.pageX,a.pageY],d=c[0]-f[0];return"left"==b._options.resizer&&(d=-d),b.resize(e(d)),!1}),a(window).one("mouseup",function(){return a(window).off("mousemove.jdatDrag"),!1}),!1}})},_bindRemove:function(){var a=this;this.widget.find(".jdat-titlebar .jdat-remove").click(function(){return a.remove(),!1})},_bindDocking:function(){var b=this;this.widget.find(".jdat-titlebar .jdat-undock").on("click",function(){return b.undocked?b.dock():b.undock(),!1}),this.widget.find(".jdat-titlebar").mousedown(function(c){if(b.undocked&&1===c.which){var d=b.widget.offset(),e=c.pageX-d.left,f=c.pageY-d.top;return a(window).on("mousemove.jdatDrag",function(a){var c=a.pageX-e,d=a.pageY-f;return b.widget.css("left",c),b.widget.css("top",d),!1}),a(window).one("mouseup.jdatDrag",function(){return a(window).off("mousemove.jdatDrag"),!1}),!1}})},_bindSettings:function(){var a=this;this.widget.find(".jdat-settings").click(function(){a._options.onSettings.call(a)})},open:function(b){var c=this;this.widget.find("ul:eq(0)").slideDown("fast",function(){a(this).show(),a.isFunction(b)&&b.call(c)}),this.widget.find(".jdat-closebar").text(this._options.closeLabel),this.widget.find("button.jdat-expand").removeClass("jdat-expand").addClass("jdat-collapse"),this.closed=!1},close:function(b){var c=this;this.widget.find("ul:eq(0)").slideUp("fast",function(){a(this).hide(),a.isFunction(b)&&b.call(c)}),this.widget.find(".jdat-closebar").text(this._options.openLabel),this.widget.find("button.jdat-collapse").removeClass("jdat-collapse").addClass("jdat-expand"),this.closed=!0},resize:function(a){this.widget.width(a)},empty:function(){this.widget.find(".jdat-section-panel:eq(0)").empty()},remove:function(){this.widget.fadeOut("fast",function(){a(this).remove()})},undock:function(){if(!this.undocked){var a=this.widget.offset();this.widget.detach().appendTo("body").css("position","absolute").css("left",a.left).css("top",a.top),this.widget.find("button.jdat-undock").removeClass("jdat-undock").addClass("jdat-dock"),"left"==this._options.resizer&&this.widget.find(".jdat-resizer").removeClass("jdat-left").addClass("jdat-right"),this.dockedPosition=[a.left,a.top],this.undocked=!0}},dock:function(){if(this.undocked){var a=this,b=function(){a.widget.detach().appendTo(a._el).css("position","").css("left","").css("top",""),a.widget.find("button.jdat-dock").removeClass("jdat-dock").addClass("jdat-undock"),"left"==a._options.resizer&&a.widget.find(".jdat-resizer").removeClass("jdat-right").addClass("jdat-left")},c=this.widget.offset();c.left!==this.dockedPosition[0]||c.top!==this.dockedPosition[1]?this.widget.animate({left:this.dockedPosition[0],top:this.dockedPosition[1]},function(){b()}):b(),this.undocked=!1}},getField:function(a){var b="#"+a+".jdat-field",c=this._el.find(b).data("jdat");return c}}),c}(),a.fn.jdat=function(b){return this.each(function(){var c=a(this),d=c.data("jdat");d||c.data("jdat",new JDat.Widget(c,b))})}}(jQuery),!function(a){"use strict";JDat.ButtonsField=function(){var b={label:"Button",holdTimeout:500,buttons:[]},c=function(c,d){c.addClass("jdat-buttons");var e=a.extend({},b,d);JDat.BaseField.call(this,c,e),this._bindButtons()};return JDat.extend(c,JDat.BaseField,{_render:function(){var b=this._template();a.each(this._options.buttons,function(c,d){if("string"==typeof d)b.append(a("<button>").html(d));else{for(var e in d)break;b.append(a("<button>").data("jdat-buttonId",buttonid).html(d.buttonId))}})},_bindButtons:function(){var b=this,c=this._el.find("button"),d=0,e=0;c.mousedown(function(c){d=1;var f=a(c.currentTarget),g=f.data("jdat-buttonId");g||(g=f);var h={value:g},i=b._options.holdTimeout,j=function(){2==d&&b._trigger(h,!1),d=2,e=setTimeout(j,i)};j();var k=function(){return clearTimeout(e),d>0&&b._trigger(h,!0),d=0,!1};return a(c.currentTarget).one("mouseup",k),a(c.currentTarget).one("mouseleave",k),!1})}}),c}()}(jQuery),!function(a){"use strict";JDat.CheckBoxField=function(){var b={label:"Check Box",value:!1},c=function(c,d){c.addClass("jdat-combobox");var e=a.extend({},b,d);JDat.BaseField.call(this,c,e),this._bindInput(),this._initialize()};return JDat.extend(c,JDat.BaseField,{_render:function(){this._template().append(a('<input type="checkbox">'))},_bindInput:function(){var b=this;this._el.find("input").change(function(c){var d=a(c.currentTarget).is(":checked");return b.value(d,!0,!0),!1})},value:function(a,b,c){if(void 0===a)return this._options.value;var a=Boolean(a);this._el.find("input").attr("checked",a),this._options.value=a;var d={value:a};b&&this._trigger(d,c)}}),c}()}(jQuery),!function(a){"use strict";JDat.ColorBarField=function(){var b={label:"Color Bar",colors:["#00ff00","#ff0000"],marker:!0,onHover:function(){}},c=function(c,d){c.addClass("jdat-colorbar");var e=a.extend({},b,d);JDat.BaseField.call(this,c,e),this._bindHover()};return JDat.extend(c,JDat.BaseField,{_render:function(){var b=this._template(),c=a('<div class="jdat-colorbar-container">');b.append(c),this.container=c;var d=a('<canvas class="jdat-colorbar-canvas">');c.append(d),this.ctx=d[0].getContext("2d");var e=a('<div class="jdat-colorbar-marker">');c.append(e),this.marker=e;var f=a('<div class="jdat-colorbar-caption">');c.append(f),this.caption=f,this._drawGradient()},_drawGradient:function(){var b=this.ctx.canvas.width,c=this.ctx.canvas.height;this.ctx.clearRect(0,0,b,c);var d=this.ctx.createLinearGradient(0,0,b,0),e=this._options.colors;a.each(e,function(a,b){var c=a/(e.length-1);d.addColorStop(c,b)}),this.ctx.fillStyle=d,this.ctx.fillRect(0,0,b,c)},_bindHover:function(){var b=this;this.container.mousemove(function(c){var d=a(b.ctx.canvas),e=d.offset(),f=Math.round(c.pageX-e.left),g=f/(d.width()-1);b._options.marker&&b.marker.show(),g>=0&&1>=g?b.marker.css("left",f+"px"):(0>g&&(g=0),g>1&&(g=1));var h=b.colorAt(g),i=b._options.onHover.call(b,g,h);return null==i?b.caption.hide():b.caption.html(i).show(),!1}),this.container.mouseleave(function(){return b.marker.hide(),b.caption.hide(),!1})},colors:function(a){return void 0===a?this._options.colors:(this._drawGradient(),void 0)},colorAt:function(a,b){var c=this.ctx.canvas,d=c.width,e=(d-1)*a,f=this.ctx.getImageData(e,0,1,1).data,g=[f[0],f[1],f[2]];return"rgb"==b?g:"hsv"==b?JDat.ColorHelper.rgb2hsv(g):JDat.ColorHelper.rgb2hex(g)}}),c}()}(jQuery),!function(a){"use strict";JDat.ColorSelectField=function(){var b={label:"Color Select",value:"#ffffff"},c=function(c,d){c.addClass("jdat-colorselect");var e=a.extend({},b,d);JDat.BaseField.call(this,c,e),this._bindInput(),this._bindSelector(),this._initialize()};return JDat.extend(c,JDat.BaseField,{_render:function(){this._template().append(a('<input type="text">').attr("spellcheck","false")).append(function(){return a('<div class="jdat-colorpicker">').append(a('<div class="jdat-saturation-field">').append(a('<div class="jdat-saturation-inner">')).append(a('<div class="jdat-saturation-knob">'))).append(a('<div class="jdat-hue-field">').append(a('<div class="jdat-hue-knob">'))).append(a('<button class="jdat-colorpicker-close">Ã—</button>'))})},_bindInput:function(){var b=this,c=this._el.find(".jdat-colorpicker");this._el.find("input").change(function(c){var d=a(c.currentTarget).val();return b.value(d,!0,!0),!1}).mousedown(function(d){a(this).parents(".jdat-widget").find(".jdat-colorpicker").hide(),c.show(),b._selectColor(b.hex,b.hsv),a(document).one("mousedown",function(){c.hide()}),d.stopPropagation()})},_bindSelector:function(){this._bindHue(),this._bindSaturation();var a=this._el.find(".jdat-colorpicker");a.mousedown(function(){return!1}),a.find(".jdat-colorpicker-close").click(function(){a.hide()})},_bindHue:function(){var b=this;this._el.find(".jdat-hue-field").mousedown(function(c){if(1===c.which){var d=a(this),e=d.offset().top,f=d.height(),g=function(a){var b=1-a/f;return b>1&&(b=1),0>b&&(b=0),b*=360},h=function(a,c){var d=a-e;b.hsv[0]=g(d),b._value("hsv",b.hsv,!0,c)};return h(c.pageY,!1),a(window).on("mousemove.jdatDrag",function(a){return h(a.pageY,!1),!1}),a(window).one("mouseup",function(b){return h(b.pageY,!0),a(window).off("mousemove.jdatDrag"),!1}),!1}})},_bindSaturation:function(){var b=this;this._el.find(".jdat-saturation-field").mousedown(function(c){if(1===c.which){var d=a(this),e=d.offset(),f=d.width(),g=d.height(),h=function(a){var b=a/f;return b>1&&(b=1),0>b&&(b=0),b},i=function(a){var b=1-a/g;return b>1&&(b=1),0>b&&(b=0),b},j=function(a,c,d){var f=a-e.left,g=c-e.top;b.hsv[1]=h(f),b.hsv[2]=i(g),b._value("hsv",b.hsv,!0,d)};return j(c.pageX,c.pageY,!1),a(window).on("mousemove.jdatDrag",function(a){return j(a.pageX,a.pageY,!1),!1}),a(window).one("mouseup",function(b){return j(b.pageX,b.pageY,!0),a(window).off("mousemove.jdatDrag"),!1}),!1}})},_setInput:function(a,b){var c=a,d=b[2]>.5&&b[1]<.5?"#000":"#fff";this._el.find("input").val(a).css("backgroundColor",c).css("color",d)},_selectColor:function(b,c){var d=this,e=this._el.find(".jdat-saturation-field"),f=function(b){var c=["-moz-","-o-","-webkit-","-ms-",""],d=JDat.ColorHelper.hsv2hex([b,1,1]),f="linear-gradient(left, #fff 0%, "+d+" 100%)";a.each(c,function(a,b){e.css("background",b+f)})},g=this._el.find(".jdat-hue-field").height(),h=this._el.find(".jdat-hue-knob"),i=function(a){var b=(1-a/360)*g;0>b&&(b=0),b>=g&&(b=g-1),h.css("top",b+"px")},j=this._el.find(".jdat-saturation-field"),k=j.width(),l=j.height(),m=d._el.find(".jdat-saturation-knob"),n=function(a,c){var d=k*a,e=(1-c)*l;0>d&&(d=0),0>e&&(e=0),d>=k&&(d=k-1),e>=l&&(e=l-1),m.css("left",d+"px"),m.css("top",e+"px"),m.css("backgroundColor",b)};f(c[0]),i(c[0]),n(c[1],c[2])},_value:function(a,b,c,d){var e,f;"hex"==a?(e=b,f=JDat.ColorHelper.hex2hsv(e)):(f=b,e=JDat.ColorHelper.hsv2hex(f)),this.hex=e,this.hsv=f,this._setInput(e,f),this._selectColor(e,f);var g=this._options.value;if(this._options.value=e,c){var h={value:e,previous:g};this._trigger(h,d)}},value:function(a,b,c){if(void 0===a)return this._options.value;a=a.replace(/^\s+|\s+$/g,""),a=a.toLowerCase();var d,e=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,f=/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/;null!==(d=a.match(e))&&(a="#",a+=d[1]+d[1],a+=d[2]+d[2],a+=d[3]+d[3]),null===(d=a.match(f))&&(a=this._options.value,b=!1),this._value("hex",a,b,c)}}),c}()}(jQuery),!function(a){"use strict";JDat.ComboBoxField=function(){var b={label:"ComboBox",selectOptions:[],value:""},c=function(c,d){c.addClass("jdat-combobox");var e=a.extend({},b,d);JDat.BaseField.call(this,c,e),this._bindSelect(),this.selectOptions(this._options.selectOptions),this._initialize()};return JDat.extend(c,JDat.BaseField,{_render:function(){this._template().append(a("<select>"))},_bindSelect:function(){var a=this;this._el.find("select").change(function(){var b=this.value;return a.value(b,!0,!0),!1})},selectOptions:function(b){if(void 0===b)return this._options.selectOptions;this._options.selectOptions=b;var c=this._el.find("select").empty();a.each(b,function(b,d){var e,f;if("string"==typeof d)e=d,f=d;else{for(e in d)break;f=d[e]}c.append(a("<option>").attr("value",e).text(f))}),b.length>0?(c.prop("disabled",!1),this._options.value=this._el.find("select").val()):c.prop("disabled",!0)},value:function(a,b,c){if(void 0===a)return this._options.value;var d=this._el.find('select option[value="'+a+'"]');if(0!=d.length){d.is(":selected")||d.attr("selected","selected");var e=this._options.value;if(this._options.value=a,b){var f={value:a,previous:e};this._trigger(f,c)}}}}),c}()}(jQuery),!function(a){"use strict";JDat.CustomField=function(){var b={label:"Custom",hasLabel:!0,classes:[],render:function(){}},c=function(c,d){c.addClass("jdat-custom");var e=a.extend({},b,d);JDat.BaseField.call(this,c,e)};return JDat.extend(c,JDat.BaseField,{_render:function(){a.each(this._options.classes,function(a,b){this._el.addClass(b)});var b=this._options.render(this);this._options.hasLabel?this._template().append(b):this._el.append(b)}}),c}()}(jQuery),!function(a){"use strict";JDat.ProgressBarField=function(){var b={label:"Progress Bar",value:0,text:"Loading ..."},c=function(c,d){c.addClass("jdat-progressbar");var e=a.extend({},b,d);JDat.BaseField.call(this,c,e),this.value(this._options.value,!1),this.text(this._options.text)};return JDat.extend(c,JDat.BaseField,{_render:function(){var b=a('<div class="jdat-progressbar-bg">').append(a('<span class="jdat-progressbar-fg">')).append(a('<div class="jdat-progressbar-overlay">'));this._template().append(b)},value:function(a,b,c){if(void 0===a)return this._options.value;a=parseInt(a),isNaN(a)?(a=this._options.value,b=!1):(0>a||a>100)&&(a=this._options.value,b=!1);var d=this._options.value;if(this._options.value=a,this._el.find(".jdat-progressbar-bg span").css("width",a+"%"),b){var e={value:a,previous:d};this._trigger(e,c)}},text:function(a){return void 0===a?this._options.text:(this._el.find(".jdat-progressbar-overlay").text(a),void 0)}}),c}()}(jQuery),!function(a){"use strict";JDat.SliderField=function(){var b={label:"Slider",max:100,min:1,step:1,value:50},c=function(c,d){c.addClass("jdat-slider");var e=a.extend({},b,d);JDat.BaseField.call(this,c,e),this._bindSlide(),this._bindInput(),this._initialize()};return JDat.extend(c,JDat.BaseField,{_render:function(){this._template().append(a('<input type="text">')).append(function(){return a('<div class="jdat-slider-bg">').append(a('<div class="jdat-slider-fg">'))})},_bindSlide:function(){var b=this;this._el.find(".jdat-slider-bg").mousedown(function(c){if(1===c.which){var d=b._el.find(".jdat-slider-bg"),e=d.offset(),f=d.width(),g=b._options.min,h=b._options.max,i=function(a,c){var d=e.left,i=g+(h-g)*((a-d)/f);b.value(i,!0,c)};return i(c.pageX,!1),a(window).on("mousemove.jdatDrag",function(a){return i(a.pageX,!1),!1}),a(window).one("mouseup",function(b){return i(b.pageX,!0),a(window).off("mousemove.jdatDrag"),!1}),!1}})},_bindInput:function(){var b=this;this._el.find("input").change(function(c){var d=a(c.currentTarget).val();return b.value(d,!0,!0),!1}).mousedown(function(c){if(1===c.which){var d=c.pageY,e=b._options.step,f=b._options.value,g=f;a(window).on("mousemove.jdatDrag",function(a){var c=d-a.pageY;return g=c/10*e+f,b.value(g,!0,!1),!1}),a(window).one("mouseup",function(){return b.value(g,!0,!0),a(window).off("mousemove.jdatDrag"),!1})}})},_setSlider:function(){var a=this._options.value,b=this._options.max,c=this._options.min,d=(a-c)/(b-c),e=100*d+"%";this._el.find(".jdat-slider-fg").width(e)},_setInput:function(){var a=this._options.value;this._el.find("input").val(a)},label:function(a){return void 0===a?this._options.label:(this._options.label=a,this._el.find(".jdat-field-label").text(a),void 0)},max:function(a,b,c){return void 0===a?this._options.max:(this._options.max=a,this._options.value>a&&this.value(this._options.value,b,c),void 0)},min:function(a,b,c){return void 0===a?this._options.min:(this._options.min=a,this._options.value<a&&this.value(this._options.value,b,c),void 0)},step:function(a){return void 0===a?this._options.step:(this._options.step=a,void 0)},value:function(a,b,c){if(void 0===a)return this._options.value;a=Number(a),isNaN(a)&&(a=this._options.value,b=!1),a<this._options.min?a=this._options.min:a>this._options.max&&(a=this._options.max);var d=this._options.step;if(a%d!=0){var e=String(d),f=0;e.indexOf(".")>-1&&(f=e.length-e.indexOf(".")-1);var g=Math.pow(10,f);a=Math.round(a/d)*d,a=Math.round(a*g)/g}var h=this._options.value;if(this._options.value=a,this._setSlider(),this._setInput(),b){var i={value:a,previous:h};this._trigger(i,c)}}}),c}()}(jQuery),!function(a){"use strict";JDat.StringField=function(){var b={label:"String",value:"",maxLength:100,minLength:0,regexp:null,strip:!1},c=function(c,d){c.addClass("jdat-string");var e=a.extend({},b,d);JDat.BaseField.call(this,c,e),this._bindInput(),this._initialize()};return JDat.extend(c,JDat.BaseField,{_render:function(){this._template().append(a('<input type="text">'))},_bindInput:function(){var b=this;this._el.find("input").change(function(c){var d=a(c.currentTarget).val();return b.value(d,!0,!0),!1}).keyup(function(c){if(13!=c.keyCode){var d=a(c.currentTarget).val();b.value(d,!0,!1)}})},value:function(a,b,c){if(void 0===a)return this._options.value;var d=!0;this._options.strip&&(a=a.replace(/^\s+|\s+$/g,""));var e=a.length;(e>this._options.maxLength||e<this._options.minLength)&&(d=!1);var f=this._options.regexp;f&&!f.test(a)&&(d=!1),d||(a=this._options.value,b=!1);var g=this._options.value;if(this._options.value=a,this._el.find("input").val(a),b){var h={value:a,previous:g};this._trigger(h,c)}},minLength:function(a){return void 0===a?this._options.minLength:(a=Number(a),this._options.minLength=a,void 0)},maxLength:function(a){return void 0===a?this._options.maxLength:(a=Number(a),this._options.maxLength=a,void 0)},strip:function(a){return void 0===a?this._options.stip:(a=Boolean(a),this._options.strip=a,void 0)},regexp:function(a){return void 0===a?this._options.regexp:(a=RegExp(a),this._options.regexp=a,void 0)}}),c}()}(jQuery),!function(a){"use strict";JDat.ToggleField=function(){var b={label:"Toggle",value:!1},c=function(c,d){c.addClass("jdat-toggle");var e=a.extend({},b,d);JDat.BaseField.call(this,c,e),this._bindToggle(),this._initialize()};return JDat.extend(c,JDat.BaseField,{_render:function(){this._template().append(a('<div class="jdat-toggle-bg">').append(a('<div class="jdat-toggle-fg">').text("OFF")))},_bindToggle:function(){var a=this;this._el.find(".jdat-toggle-bg").click(function(){return a.value(!a.value(),!0,!0),!1})},value:function(a,b,c){if(void 0===a)return this._options.value;var a=Boolean(a),d=this._el.find(".jdat-toggle-fg");a?(d.addClass("jdat-toggle-on"),d.text("ON")):(d.removeClass("jdat-toggle-on"),d.text("OFF")),this._options.value=a;var e={value:a};b&&this._trigger(e,c)}}),c}()}(jQuery);